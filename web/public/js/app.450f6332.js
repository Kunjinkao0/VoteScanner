(function(){"use strict";var t={9607:function(t,e,a){var o=a(9242),n=a(3396);function s(t,e,a,o,s,i){const c=(0,n.up)("MainControl");return(0,n.wg)(),(0,n.j4)(c)}a(8858),a(1318),a(3228);var i=a(7139),c=a.p+"img/arrow-rotate-left.ceca8d0c.svg",r=a(6119),l=a.p+"img/file-arrow-down.5018bb12.svg",u=a.p+"img/reset.a1e8035d.svg",v=a.p+"img/minus.ec8a0658.svg",d=a.p+"img/plus.31557153.svg",p=a.p+"img/start.eaa00c3d.svg",g=a.p+"img/stop.5388b59e.svg",w=a.p+"img/caret-left.f2405eb9.svg",m=a.p+"img/caret-right.0d29fed0.svg",h=a.p+"img/close.2372de4f.svg",f=a(4870);const _=["data-text"];var b={__name:"GeekLogo",setup(t){const e=(0,f.iH)("Powered by GeekIoT"),a=(0,f.iH)(!1);let o=-1;return(0,n.bv)((()=>{o=setInterval((()=>{const t=Math.random()>.4;a.value=t}),3e3)})),(0,n.Ah)((()=>{clearInterval(o)})),(t,o)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,i.C_)(["text",{glitch:a.value}]),"data-text":e.value},(0,i.zw)(e.value),11,_))}},k=a(89);const y=(0,k.Z)(b,[["__scopeId","data-v-65c24762"]]);var j=y,C=a(4161);const D=C.Z.create();D.interceptors.response.use((t=>200===t.status?t.data:Promise.reject(new Error(t.data))),(t=>Promise.reject(t)));var x=D;const H=t=>((0,n.dD)("data-v-f4ed22fc"),t=t(),(0,n.Cn)(),t),O={class:"content"},I={class:"details"},P={class:"left"},z={class:"project-desc"},L={class:"project-name"},q=["src"],E={class:"right"},M={class:"vote-number"},V={class:"vote-number-frame"},T={class:"control-btns"},A={class:"control-btns-left"},F=H((()=>(0,n._)("img",{src:u,alt:"Vote reset",width:"48",height:"48"},null,-1))),Z=[F],W=H((()=>(0,n._)("img",{src:v,alt:"Vote down",width:"48",height:"48"},null,-1))),B=[W],R=H((()=>(0,n._)("img",{src:d,alt:"Vote up",width:"48",height:"48"},null,-1))),S=[R],Y={key:0,src:p,alt:"Vote start",width:"48",height:"48"},$={key:1,src:g,alt:"Vote stop",width:"48",height:"48"},G=H((()=>(0,n._)("img",{src:w,alt:"Previous",width:"48",height:"48"},null,-1))),K=[G],U=H((()=>(0,n._)("img",{src:m,alt:"Next",width:"48",height:"48"},null,-1))),J=[U],N=H((()=>(0,n._)("img",{src:h,alt:"Close",width:"48",height:"48"},null,-1))),Q=[N];var X={__name:"VoteModal",props:{project:Object,isFirst:Boolean,isLast:Boolean},emits:["modalVisible","changeProject"],setup(t,{emit:e}){const s=t,c=e,r=(0,f.iH)(!1),l=(0,f.iH)(0),u=(0,f.iH)(a(6119)),v=(0,f.iH)(!1),d=()=>{c("modalVisible",!1),k()},p=()=>{s.isFirst||(c("changeProject",-1),k())},g=()=>{s.isLast||(c("changeProject",1),k())},w=async()=>{const t=await x.get(`/api/vote/project/${s.project.id}/total`);l.value=t.total};(0,n.bv)((()=>{setTimeout((()=>{v.value=!0}),1),w(),window.addEventListener("keydown",m)})),(0,n.Jd)((()=>{window.removeEventListener("keydown",m)})),(0,n.YP)((()=>s.project),(()=>{w()}));const m=t=>{"Escape"===t.key?d():"ArrowLeft"===t.key?p():"ArrowRight"===t.key?g():"Enter"===t.key&&h()},h=async()=>{r.value?k():b()};let _=-1;const b=async()=>{try{await x.post("/api/vote/start",{pid:s.project.id}),r.value=!0,_=setInterval((()=>{w()}),1e3)}catch(t){console.error(t)}},k=async()=>{_>0&&clearInterval(_);try{await x.post("/api/vote/stop"),r.value=!1}catch(t){console.error(t)}},y=async()=>{try{await x.post("/api/vote/reset",{pid:s.project.id}),l.value=0}catch(t){console.error(t)}},C=async t=>{try{const e=t>0?"admin-up":"admin-down",a=await x.post("/api/vote/submit",{pid:s.project.id,deviceId:e});l.value=a.total}catch(e){console.error(e)}};return(t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:"mask",onClick:d},[(0,n.Wm)(o.uT,{name:"modal"},{default:(0,n.w5)((()=>[v.value?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"modal-wrapper noselect",onClick:e[5]||(e[5]=(0,o.iM)((()=>{}),["stop"]))},[(0,n._)("div",O,[(0,n._)("div",I,[(0,n._)("div",P,[(0,n._)("div",z,(0,i.zw)(s.project.desc),1),(0,n._)("div",L,(0,i.zw)(s.project.name),1),(0,n._)("div",null,[(0,n._)("image",{class:"project-cover",src:u.value},null,8,q)])]),(0,n._)("div",E,[(0,n._)("div",M,[(0,n._)("span",V,(0,i.zw)(l.value),1)])])]),(0,n._)("div",T,[(0,n._)("div",A,[(0,n._)("button",{class:"vote-ctrl",onClick:e[0]||(e[0]=t=>y())},Z),(0,n._)("button",{class:"vote-ctrl",onClick:e[1]||(e[1]=t=>C(-1))},B),(0,n._)("button",{class:"vote-ctrl",onClick:e[2]||(e[2]=t=>C(1))},S)]),(0,n._)("button",{class:"vote-ctrl",style:{width:"400px","margin-left":"100px"},onClick:e[3]||(e[3]=t=>h())},[r.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("img",Y)),r.value?((0,n.wg)(),(0,n.iD)("img",$)):(0,n.kq)("",!0)])])]),s.isFirst?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn-center btn-center-left",onClick:p},K)),s.isLast?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("button",{key:1,class:"btn-center btn-center-right",onClick:g},J)),(0,n._)("button",{class:"btn-close",onClick:d},Q),(0,n.Wm)(j,{class:"geek-logo noselect",onClick:e[4]||(e[4]=(0,o.iM)((()=>{}),["stop"]))})])):(0,n.kq)("",!0)])),_:1})]))}};const tt=(0,k.Z)(X,[["__scopeId","data-v-f4ed22fc"]]);var et=tt;const at=t=>((0,n.dD)("data-v-32976ce0"),t=t(),(0,n.Cn)(),t),ot={class:"page"},nt={class:"content"},st={key:0,class:"projects-card"},it=["onClick"],ct={class:"project-name"},rt={class:"project-vote"},lt={class:"project-desc"},ut={key:1,class:"project-list-wrapper noselect"},vt={class:"projects-list"},dt={class:"list-header"},pt=at((()=>(0,n._)("img",{src:c,width:"32",height:"32"},null,-1))),gt=[pt],wt=at((()=>(0,n._)("img",{class:"list-header-logo",src:r,height:"150"},null,-1))),mt=at((()=>(0,n._)("img",{src:l,width:"32",height:"32"},null,-1))),ht=[mt],ft={class:"list-item-wrapper"},_t={class:"project-index"},bt={class:"project-name"},kt={class:"project-vote"},yt={key:0,class:"footer"};var jt={__name:"MainControl",setup(t){const e=(0,f.iH)(!0);(0,n.bv)((()=>{a(),s(),window.addEventListener("keydown",(function(t){32==t.keyCode&&t.target==document.body&&t.preventDefault()}))}));const a=async()=>{const t=await x.get("/api/projects");v.value=t.sort(((t,e)=>t.desc.localeCompare(e.desc)))},s=async()=>{const t=await x.get("/api/vote/results"),e=v.value.map((e=>({...e,total:t.find((t=>t.projectId===e.id))?.total||0})));v.value=e},c=(0,n.Fl)((()=>{const t=[...v.value];return t.sort(((t,e)=>e.total-t.total))})),l=()=>{u.value=!1,s()},u=(0,f.iH)(!1),v=(0,f.iH)([]),d=(0,f.iH)(null),p=(0,f.iH)(!1),g=(0,f.iH)(!1),w=(t,e)=>{const a=v.value;p.value=0===e,g.value=e===a.length-1,d.value=t,u.value=!0},m=t=>{const e=v.value,a=e.findIndex((t=>t===d.value))+t;p.value=0===a,g.value=a===e.length-1,d.value=e[a]},h=()=>{let t="Team,Score\r\n";c.value.forEach((e=>{const a=[e.name,e.total];t+=a.map((t=>`${t}`)).join(",")+"\r\n"}));const e=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(e),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download",`Score_${(new Date).toTimeString().split(" ")[0].replace(/:/g,"")}.csv`),document.body.appendChild(o),o.click(),document.body.removeChild(o)};return(t,a)=>((0,n.wg)(),(0,n.iD)("div",ot,[(0,n._)("div",nt,[e.value?((0,n.wg)(),(0,n.iD)("div",st,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(v.value,((t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:"card-wrapper",key:t.id},[(0,n._)("div",{class:"card",onClick:a=>w(t,e)},[(0,n._)("div",ct,(0,i.zw)(t.name),1),(0,n._)("div",rt,(0,i.zw)(t.total),1),(0,n._)("div",lt,(0,i.zw)(t.desc),1)],8,it)])))),128))])):(0,n.kq)("",!0),e.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",ut,[(0,n._)("div",vt,[(0,n._)("div",dt,[(0,n._)("button",{class:"list-header-button",onClick:a[0]||(a[0]=t=>e.value=!0)},gt),wt,(0,n._)("button",{class:"list-header-button",onClick:h},ht)]),(0,n._)("div",ft,[(0,n.Wm)(o.W3,{name:"list"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.value,((t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:"list-item",key:t.id},[(0,n._)("span",_t,(0,i.zw)(e+1),1),(0,n._)("span",bt,(0,i.zw)(t.name),1),(0,n._)("span",kt,(0,i.zw)(t.total),1)])))),128))])),_:1})])])]))]),e.value?((0,n.wg)(),(0,n.iD)("div",yt,[(0,n._)("img",{class:"footer-logo",src:r,height:"180",onClick:a[1]||(a[1]=t=>e.value=!1)})])):(0,n.kq)("",!0),u.value?((0,n.wg)(),(0,n.j4)(et,{key:1,onModalVisible:l,project:d.value,"is-first":p.value,"is-last":g.value,onChangeProject:a[2]||(a[2]=t=>m(t))},null,8,["project","is-first","is-last"])):(0,n.kq)("",!0)]))}};const Ct=(0,k.Z)(jt,[["__scopeId","data-v-32976ce0"]]);var Dt=Ct,xt={name:"App",components:{MainControl:Dt}};const Ht=(0,k.Z)(xt,[["render",s]]);var Ot=Ht;const It=(0,o.ri)(Ot);It.mount("#app")},6119:function(t,e,a){t.exports=a.p+"img/logo-with-shade.11b3ec61.png"}},e={};function a(o){var n=e[o];if(void 0!==n)return n.exports;var s=e[o]={exports:{}};return t[o].call(s.exports,s,s.exports,a),s.exports}a.m=t,function(){var t=[];a.O=function(e,o,n,s){if(!o){var i=1/0;for(u=0;u<t.length;u++){o=t[u][0],n=t[u][1],s=t[u][2];for(var c=!0,r=0;r<o.length;r++)(!1&s||i>=s)&&Object.keys(a.O).every((function(t){return a.O[t](o[r])}))?o.splice(r--,1):(c=!1,s<i&&(i=s));if(c){t.splice(u--,1);var l=n();void 0!==l&&(e=l)}}return e}s=s||0;for(var u=t.length;u>0&&t[u-1][2]>s;u--)t[u]=t[u-1];t[u]=[o,n,s]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var o in e)a.o(e,o)&&!a.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.p="/"}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,o){var n,s,i=o[0],c=o[1],r=o[2],l=0;if(i.some((function(e){return 0!==t[e]}))){for(n in c)a.o(c,n)&&(a.m[n]=c[n]);if(r)var u=r(a)}for(e&&e(o);l<i.length;l++)s=i[l],a.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return a.O(u)},o=self["webpackChunkui"]=self["webpackChunkui"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=a.O(void 0,[998],(function(){return a(9607)}));o=a.O(o)})();
//# sourceMappingURL=app.450f6332.js.map